---
title: "Spatial Data Manipulation"
output: html_notebook
---
* Dante Christopher-Alphonso <dantealphonso@gmail.com>

## Libraries
```{r}
# Loading packages for being able to manipulate and plot spatial data
library(tidyverse)
library(sf)
library(ggplot2)
```

## Data
```{r}
# Reading in the Former Municipality Boundaries Data GeoJson file
fmbd <- st_read('data/Former Municipality Boundaries Data.geojson')

# Reading in the Community Shelters shapefile and reprojecting
shelters <- st_read("data/Shelter/shelters_wgs84.shp") %>% st_transform(3857)

# Reading in the Neighbourhoods GeoJson File and reprojecting
ngh <- st_read("data/Neighbourhoods.geojson") %>% st_transform(3857)

# Reading in the Neighbourhood Improvement Areas GeoJson File and reprojecting
ngh_imp <- st_read("data/Neighbourhood Improvement Areas.geojson") %>% st_transform(3857)
```

## Summary Statistics

### Finding Maximum value

```{r}
max(fmbd$AREA_SHORT_CODE)
```

### Finding Mean value

```{r}
mean(shelters$CENTRELINE)
```

## Reprojecting a spatial file

### Showing the current projection of a spatial file

```{r}
# Displaying the Former Municipality Boundaries Data file's current CRS
st_crs(fmbd)

# Plotting the Former Municipality Boundaries Data file as a map
plot(st_geometry(fmbd))
```

### Reprojection of the spatial file

```{r}
# Wipe the CRS of fmbd and set it to WGS 84 / UTM zone 33N projection
fmbd_new <- fmbd  %>% st_set_crs(NA) %>% st_set_crs(32633)

# Coordinate transformation to WGS 84 / UTM zone 33N projection
fmbd_new <- fmbd  %>% st_transform(32633)

# Plotting re projected fmbd
plot(st_geometry(fmbd_new))
```
### Trying a different reprojection
```{r}
# Wipe the CRS of fmbd and set it to NAD83(CSRS) / Statistics Canada Lambert
fmbd_new2 <- fmbd  %>% st_set_crs(NA) %>% st_set_crs(3348)

# Coordinate transformation to NAD83(CSRS) / Statistics Canada Lambert
fmbd_new2 <- fmbd  %>% st_transform(3348)

# Plotting re projected fmbd
plot(st_geometry(fmbd_new2))
```
## Creating a new column by combining two existing columns
```{r}
# Combining the AREA_SHORT_CODE column and the AREA_LONG_CODE column together to create the AREA_NEW_CODE column
fmbd$AREA_NEW_CODE <- paste(fmbd$AREA_SHORT_CODE, fmbd$AREA_LONG_CODE)

# Reading the new table of the same fmbd file
fmbd
```
## Creating buffers for a spatial file
```{r}
# Creates 1000 metre buffers for shelters file 
buffers <- st_buffer(shelters, dist = 1000)


# Plots buffers on a map, with the original shelters being coloured red
ggplot() +
 geom_sf(data = buffers, color = 'blue') +
 geom_sf(data = shelters, color = 'red')
```
## Joining two spatial files
```{r}
# Joining the ngh file to the ngh_imp file
joined_data <- st_join(ngh, ngh_imp)
```

